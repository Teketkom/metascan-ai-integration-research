# Lua Автоматизация — сгенерированные и рекомендованные рецепты

## 1. Роль Lua/Nmap NSE в автоматизации
- Nmap NSE (Network Scripting Engine) позволяет использовать Lua для кастомных проверок уязвимостей, автоматизации discovery и интеграции с ML-предсказаниями

## 2. AI-Driven Lua генерация: рецепт
**Пример автогенерации скрипта для детектора паттерна (используйте встроенный ai_nse_generator.py):**

```lua
-- NSE script AI-generated
local shortport = require "shortport"
local http = require "http"
local vulns = require "vulns"
local stdnse = require "stdnse"

description = [[
Авто-сгенерированный AI Lua скрипт: проверка небезопасного HTTP сервиса
]]
categories = {"vuln", "safe"}
portrule = shortport.http
---
action = function(host, port)
    local vuln_table = {
        title = "Unsafe HTTP Version Detected",
        state = vulns.STATE.NOT_VULN
    }
    local response = http.get(host, port, "/")
    if response and response.body and response.body:find("BadVersion/0.8") then
        vuln_table.state = vulns.STATE.VULN
        stdnse.debug1("[AI] Vulnerable HTTP version found!")
    end
    return vulns.Report:new(SCRIPT_NAME, host, port):make_output(vuln_table)
end
```

## 3. Автоматизированные пайплайны
- Генерация Lua из LLM по описанию (ai_nse_generator.py --cve ...)
- Подключение Lua скриптов напрямую как ML-action (after prediction)
- Применение шаблонов для паттернов (белый/чёрный список)

## 4. Best Practices
- Всегда логируйте действия (stdnse.debug1)
- Не выполняйте destructive actions через AI генератор
- Проверяйте изменяемые endpoints через PoC
- Храните autogenerated Lua отдельно от ручных

---
**Документ подготовлен:** 26.11.2025 (NSE & AI Automation Specialist)
# Metascan AI Integration Research
